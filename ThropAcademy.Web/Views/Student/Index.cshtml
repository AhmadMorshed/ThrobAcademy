@model IEnumerable<Throb.Data.Entities.Student>

@{
    ViewData["Title"] = "إدارة الطلاب";
    // ❌ تم حذف تعريف متغيرات الألوان هنا ونقلها إلى CSS Custom Properties
}


@* ⚠️ ملاحظة: يمكنك دمج الروابط التالية في _Layout.cshtml *@
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap" rel="stylesheet">


<div class="container py-5">

    <h1 class="page-title mb-4 text-center"><i class="fas fa-users-cog me-2"></i> @ViewData["Title"]</h1>

    <div class="d-flex justify-content-between align-items-center mb-4 management-header">
        <a asp-controller="Student" asp-action="Create" class="btn btn-create-action">
            <i class="fas fa-user-plus me-2"></i> إضافة طالب جديد
        </a>

        <form method="get" asp-action="Index" class="form-inline search-form">
            <div class="input-group">
                <input type="text" class="form-control search-input" name="searchInp" placeholder="البحث بالاسم..." value="" />
                <button type="submit" class="btn btn-search-icon">
                    <i class="fas fa-search"></i>
                </button>
            </div>
        </form>
    </div>

    @if (Model != null && Model.Any())
    {
        @foreach (var courseGroup in Model.Where(s => s.StudentCourses?.FirstOrDefault()?.Course != null)
            .GroupBy(s => s.StudentCourses?.FirstOrDefault()?.Course.Name))
        {
            <div class="student-group-card shadow-sm mb-5">
                <h3 class="course-group-title"><i class="fas fa-folder-open me-2"></i> كورس: @courseGroup.Key</h3>

                <div class="table-responsive">
                    <table class="table table-striped table-hover student-table">
                        <thead>
                            <tr>
                                <th class="col-id">#</th>
                                <th><i class="fas fa-user me-1"></i> @Html.DisplayNameFor(s => s.Name)</th>
                                <th><i class="fas fa-envelope me-1"></i> @Html.DisplayNameFor(s => s.Email)</th>
                                <th><i class="fas fa-lock me-1"></i> كلمة المرور</th>
                                <th class="text-center" colspan="3">الإجراءات</th>
                            </tr>
                        </thead>
                        <tbody>
                            @{
                                int sre = 1;
                            }
                            @foreach (var student in courseGroup)
                            {
                                <tr>
                                    <td class="col-id">@sre</td>
                                    <td class="col-name fw-semibold">@student.Name</td>
                                    <td>@student.Email</td>
                                    <td class="password-hidden">********</td>

                                    <td class="action-button">
                                        <a asp-action="Details" asp-route-id="@student.Id" class="btn btn-sm btn-details" title="التفاصيل">
                                            <i class="fas fa-eye"></i>
                                        </a>
                                    </td>
                                    <td class="action-button">
                                        <a asp-action="Update" asp-route-id="@student.Id" class="btn btn-sm btn-update" title="تعديل">
                                            <i class="fas fa-edit"></i>
                                        </a>
                                    </td>
                                    <td class="action-button">
                                        <a asp-action="Delete" asp-route-id="@student.Id" class="btn btn-sm btn-delete" title="حذف" onclick="return confirm('هل أنت متأكد من حذف هذا الطالب؟');">
                                            <i class="fas fa-trash"></i>
                                        </a>
                                    </td>
                                </tr>
                                sre++;
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        }
    }
    else
    {
        <div class="mt-5 alert alert-info alert-empty">
            <i class="fas fa-info-circle me-2"></i> <h3>لا يوجد طلاب مسجلين حالياً.</h3>
        </div>
    }
</div>
@* 🟢 ربط ملف CSS الخارجي *@
<link rel="stylesheet" href="~/css/Student/Index.css" />